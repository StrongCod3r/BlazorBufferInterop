# BlazorBufferInterop

BlazorBufferInterop is a sample project demonstrating advanced buffer interop between C# and JavaScript in a Blazor WebAssembly application targeting .NET10.

## Features

- **Blazor WebAssembly (.NET10)**: Modern client-side web UI with C# and Razor.
- **Buffer Interop**: Efficiently shares memory buffers between C# and JavaScript using WebAssembly.
- **Canvas Drawing**: Uses a C#-allocated buffer to draw a gradient image on an HTML canvas via JavaScript interop.
- **Unsafe Code**: Utilizes unsafe blocks and `GCHandle` to pin buffers for direct memory access.
- **Modern JS Interop**: Leverages `[JSImport]` and `IJSRuntime` for calling JavaScript functions from C#.

## How It Works

1. **Buffer Allocation**: C# allocates a byte array for RGBA pixel data.
2. **Interop**: The buffer pointer is passed to JavaScript using WebAssembly memory.
3. **JavaScript Processing**: JS fills the buffer with a color gradient and draws it on a `<canvas>` element.
4. **Result**: The canvas displays a smooth gradient generated by C# and rendered by JS.

## Usage

1. Run the project (`BlazorBufferInterop.Client`).
2. Navigate to `/interop` in your browser.
3. Click "Draw Gradient on Canvas" to see the buffer interop in action.

## Technical Details

- **.NET Target**: .NET10
- **Blazor**: WebAssembly Interactive Render Mode
- **Interop**: Uses `[JSImport]` for simple functions and `IJSRuntime` for complex scenarios (e.g., passing strings).
- **Memory Access**: JavaScript accesses WASM memory via `globalThis.getDotnetRuntime(0).Module.HEAPU8.buffer`.
- **Canvas API**: JS creates `ImageData` from the buffer and draws it using `putImageData`.

## Project Structure

- `BlazorBufferInterop.Client/Pages/Interop.razor`: UI and event handlers for buffer interop and canvas drawing.
- `BlazorBufferInterop.Client/BufferInterop.cs`: C# interop logic and buffer management.
- `BlazorBufferInterop.Client/wwwroot/main.js`: JavaScript functions for buffer manipulation and canvas rendering.

## Requirements

- .NET10 SDK
- Modern browser with WebAssembly support

## License

This project is open source and available under the MIT License.